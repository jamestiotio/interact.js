{
	"version": 3,
	"names": [
		"arr",
		"domUtils",
		"extend",
		"is",
		"InteractableSet",
		"list",
		"selectorMap",
		"scope",
		"constructor",
		"addListeners",
		"interactable",
		"target",
		"interactablesOnTarget",
		"string",
		"id",
		"targetIndex",
		"findIndex",
		"i",
		"splice",
		"new",
		"options",
		"actions",
		"Interactable",
		"document",
		"events",
		"addDocument",
		"_doc",
		"push",
		"Object",
		"defineProperty",
		"value",
		"configurable",
		"fire",
		"win",
		"_win",
		"getExisting",
		"context",
		"isSelector",
		"undefined",
		"find",
		"_context",
		"inContext",
		"forEachMatch",
		"node",
		"callback",
		"ret",
		"element",
		"matchesSelector"
	],
	"sources": [
		"InteractableSet.ts"
	],
	"sourcesContent": [
		"import type { Interactable } from '@interactjs/core/Interactable'\nimport type { OptionsArg, Options } from '@interactjs/core/options'\nimport type { Scope } from '@interactjs/core/scope'\nimport type { Target } from '@interactjs/core/types'\nimport * as arr from '@interactjs/utils/arr'\nimport * as domUtils from '@interactjs/utils/domUtils'\nimport extend from '@interactjs/utils/extend'\nimport is from '@interactjs/utils/is'\n\ndeclare module '@interactjs/core/scope' {\n  interface SignalArgs {\n    'interactable:new': {\n      interactable: Interactable\n      target: Target\n      options: OptionsArg\n      win: Window\n    }\n  }\n}\n\nexport class InteractableSet {\n  // all set interactables\n  list: Interactable[] = []\n\n  selectorMap: {\n    [selector: string]: Interactable[]\n  } = {}\n\n  scope: Scope\n\n  constructor (scope: Scope) {\n    this.scope = scope\n    scope.addListeners({\n      'interactable:unset': ({ interactable }) => {\n        const { target } = interactable\n        const interactablesOnTarget: Interactable[] = is.string(target)\n          ? this.selectorMap[target]\n          : (target as any)[this.scope.id]\n\n        const targetIndex = arr.findIndex(interactablesOnTarget, (i) => i === interactable)\n        interactablesOnTarget.splice(targetIndex, 1)\n      },\n    })\n  }\n\n  new (target: Target, options?: any): Interactable {\n    options = extend(options || {}, {\n      actions: this.scope.actions,\n    })\n    const interactable = new this.scope.Interactable(target, options, this.scope.document, this.scope.events)\n\n    this.scope.addDocument(interactable._doc)\n    this.list.push(interactable)\n\n    if (is.string(target)) {\n      if (!this.selectorMap[target]) {\n        this.selectorMap[target] = []\n      }\n      this.selectorMap[target].push(interactable)\n    } else {\n      if (!(interactable.target as any)[this.scope.id]) {\n        Object.defineProperty(target, this.scope.id, {\n          value: [],\n          configurable: true,\n        })\n      }\n\n      ;(target as any)[this.scope.id].push(interactable)\n    }\n\n    this.scope.fire('interactable:new', {\n      target,\n      options,\n      interactable,\n      win: this.scope._win,\n    })\n\n    return interactable\n  }\n\n  getExisting (target: Target, options?: Options) {\n    const context = (options && options.context) || this.scope.document\n    const isSelector = is.string(target)\n    const interactablesOnTarget: Interactable[] = isSelector\n      ? this.selectorMap[target as string]\n      : (target as any)[this.scope.id]\n\n    if (!interactablesOnTarget) return undefined\n\n    return arr.find(\n      interactablesOnTarget,\n      (interactable) =>\n        interactable._context === context && (isSelector || interactable.inContext(target as any)),\n    )\n  }\n\n  forEachMatch<T> (node: Node, callback: (interactable: Interactable) => T): T | void {\n    for (const interactable of this.list) {\n      let ret: T\n\n      if (\n        (is.string(interactable.target)\n          ? // target is a selector and the element matches\n          is.element(node) && domUtils.matchesSelector(node, interactable.target)\n          : // target is the element\n          node === interactable.target) &&\n        // the element is in context\n        interactable.inContext(node)\n      ) {\n        ret = callback(interactable)\n      }\n\n      if (ret !== undefined) {\n        return ret\n      }\n    }\n  }\n}\n"
	],
	"mappings": "AAIA,OAAO,KAAKA,GAAZ,MAAqB,iBAArB;AACA,OAAO,KAAKC,QAAZ,MAA0B,sBAA1B;AACA,OAAOC,MAAP,MAAmB,oBAAnB;AACA,OAAOC,EAAP,MAAe,gBAAf;AAaA,OAAO,MAAMC,eAAN,CAAsB;EAC3B;EACAC,IAAI,GAAmB,EAAnB;EAEJC,WAAW,GAEP,EAFO;EAIXC,KAAK;;EAELC,WAAW,CAAED,KAAF,EAAgB;IACzB,KAAKA,KAAL,GAAaA,KAAb;IACAA,KAAK,CAACE,YAAN,CAAmB;MACjB,sBAAsB,CAAC;QAAEC;MAAF,CAAD,KAAsB;QAC1C,MAAM;UAAEC;QAAF,IAAaD,YAAnB;QACA,MAAME,qBAAqC,GAAGT,EAAE,CAACU,MAAH,CAAUF,MAAV,IAC1C,KAAKL,WAAL,CAAiBK,MAAjB,CAD0C,GAEzCA,MAAD,CAAgB,KAAKJ,KAAL,CAAWO,EAA3B,CAFJ;QAIA,MAAMC,WAAW,GAAGf,GAAG,CAACgB,SAAJ,CAAcJ,qBAAd,EAAsCK,CAAD,IAAOA,CAAC,KAAKP,YAAlD,CAApB;QACAE,qBAAqB,CAACM,MAAtB,CAA6BH,WAA7B,EAA0C,CAA1C;MACD;IATgB,CAAnB;EAWD;;EAEDI,GAAG,CAAER,MAAF,EAAkBS,OAAlB,EAA+C;IAChDA,OAAO,GAAGlB,MAAM,CAACkB,OAAO,IAAI,EAAZ,EAAgB;MAC9BC,OAAO,EAAE,KAAKd,KAAL,CAAWc;IADU,CAAhB,CAAhB;IAGA,MAAMX,YAAY,GAAG,IAAI,KAAKH,KAAL,CAAWe,YAAf,CAA4BX,MAA5B,EAAoCS,OAApC,EAA6C,KAAKb,KAAL,CAAWgB,QAAxD,EAAkE,KAAKhB,KAAL,CAAWiB,MAA7E,CAArB;IAEA,KAAKjB,KAAL,CAAWkB,WAAX,CAAuBf,YAAY,CAACgB,IAApC;IACA,KAAKrB,IAAL,CAAUsB,IAAV,CAAejB,YAAf;;IAEA,IAAIP,EAAE,CAACU,MAAH,CAAUF,MAAV,CAAJ,EAAuB;MACrB,IAAI,CAAC,KAAKL,WAAL,CAAiBK,MAAjB,CAAL,EAA+B;QAC7B,KAAKL,WAAL,CAAiBK,MAAjB,IAA2B,EAA3B;MACD;;MACD,KAAKL,WAAL,CAAiBK,MAAjB,EAAyBgB,IAAzB,CAA8BjB,YAA9B;IACD,CALD,MAKO;MACL,IAAI,CAAEA,YAAY,CAACC,MAAd,CAA6B,KAAKJ,KAAL,CAAWO,EAAxC,CAAL,EAAkD;QAChDc,MAAM,CAACC,cAAP,CAAsBlB,MAAtB,EAA8B,KAAKJ,KAAL,CAAWO,EAAzC,EAA6C;UAC3CgB,KAAK,EAAE,EADoC;UAE3CC,YAAY,EAAE;QAF6B,CAA7C;MAID;;MAED;MAAEpB,MAAD,CAAgB,KAAKJ,KAAL,CAAWO,EAA3B,EAA+Ba,IAA/B,CAAoCjB,YAApC;IACF;;IAED,KAAKH,KAAL,CAAWyB,IAAX,CAAgB,kBAAhB,EAAoC;MAClCrB,MADkC;MAElCS,OAFkC;MAGlCV,YAHkC;MAIlCuB,GAAG,EAAE,KAAK1B,KAAL,CAAW2B;IAJkB,CAApC;IAOA,OAAOxB,YAAP;EACD;;EAEDyB,WAAW,CAAExB,MAAF,EAAkBS,OAAlB,EAAqC;IAC9C,MAAMgB,OAAO,GAAIhB,OAAO,IAAIA,OAAO,CAACgB,OAApB,IAAgC,KAAK7B,KAAL,CAAWgB,QAA3D;IACA,MAAMc,UAAU,GAAGlC,EAAE,CAACU,MAAH,CAAUF,MAAV,CAAnB;IACA,MAAMC,qBAAqC,GAAGyB,UAAU,GACpD,KAAK/B,WAAL,CAAiBK,MAAjB,CADoD,GAEnDA,MAAD,CAAgB,KAAKJ,KAAL,CAAWO,EAA3B,CAFJ;IAIA,IAAI,CAACF,qBAAL,EAA4B,OAAO0B,SAAP;IAE5B,OAAOtC,GAAG,CAACuC,IAAJ,CACL3B,qBADK,EAEJF,YAAD,IACEA,YAAY,CAAC8B,QAAb,KAA0BJ,OAA1B,KAAsCC,UAAU,IAAI3B,YAAY,CAAC+B,SAAb,CAAuB9B,MAAvB,CAApD,CAHG,CAAP;EAKD;;EAED+B,YAAY,CAAKC,IAAL,EAAiBC,QAAjB,EAAwE;IAClF,KAAK,MAAMlC,YAAX,IAA2B,KAAKL,IAAhC,EAAsC;MACpC,IAAIwC,GAAJ;;MAEA,IACE,CAAC1C,EAAE,CAACU,MAAH,CAAUH,YAAY,CAACC,MAAvB,IACG;MACFR,EAAE,CAAC2C,OAAH,CAAWH,IAAX,KAAoB1C,QAAQ,CAAC8C,eAAT,CAAyBJ,IAAzB,EAA+BjC,YAAY,CAACC,MAA5C,CAFrB,GAGG;MACFgC,IAAI,KAAKjC,YAAY,CAACC,MAJxB,KAKA;MACAD,YAAY,CAAC+B,SAAb,CAAuBE,IAAvB,CAPF,EAQE;QACAE,GAAG,GAAGD,QAAQ,CAAClC,YAAD,CAAd;MACD;;MAED,IAAImC,GAAG,KAAKP,SAAZ,EAAuB;QACrB,OAAOO,GAAP;MACD;IACF;EACF;;AAhG0B"
}