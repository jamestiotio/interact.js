{
	"version": 3,
	"names": [
		"arr",
		"browser",
		"clone",
		"getElementRect",
		"matchesUpTo",
		"nodeContains",
		"trySelector",
		"extend",
		"is",
		"isNonNativeEvent",
		"normalizeListeners",
		"getWindow",
		"Eventable",
		"OnOffMethod",
		"Interactable",
		"_defaults",
		"base",
		"perAction",
		"actions",
		"options",
		"_actions",
		"target",
		"events",
		"_context",
		"_win",
		"_doc",
		"_scopeEvents",
		"constructor",
		"defaultContext",
		"scopeEvents",
		"context",
		"document",
		"set",
		"setOnEvents",
		"actionName",
		"phases",
		"func",
		"onstart",
		"on",
		"onmove",
		"onend",
		"oninertiastart",
		"updatePerActionListeners",
		"prev",
		"cur",
		"actionFilter",
		"map",
		"filterEventType",
		"filter",
		"type",
		"array",
		"object",
		"_onOff",
		"Off",
		"undefined",
		"On",
		"setPerAction",
		"defaults",
		"optionName_",
		"optionName",
		"actionOptions",
		"optionValue",
		"listeners",
		"from",
		"plainObject",
		"enabled",
		"bool",
		"getRect",
		"element",
		"string",
		"querySelector",
		"rectChecker",
		"checker",
		"rect",
		"apply",
		"width",
		"right",
		"left",
		"height",
		"bottom",
		"top",
		"_backCompatOption",
		"newValue",
		"action",
		"origin",
		"deltaSource",
		"getAllElements",
		"Array",
		"querySelectorAll",
		"inContext",
		"ownerDocument",
		"testIgnoreAllow",
		"targetNode",
		"eventTarget",
		"testIgnore",
		"ignoreFrom",
		"testAllow",
		"allowFrom",
		"fire",
		"iEvent",
		"method",
		"typeArg",
		"listenerArg",
		"wheelEvent",
		"listener",
		"types",
		"off",
		"actionName_",
		"methodDict",
		"methodName",
		"setting",
		"unset",
		"delegatedEvents",
		"delegated",
		"i",
		"length",
		"selector",
		"splice",
		"l",
		"removeDelegate",
		"remove"
	],
	"sources": [
		"Interactable.ts"
	],
	"sourcesContent": [
		"/* eslint-disable no-dupe-class-members */\nimport type { Scope } from '@interactjs/core/scope'\nimport type {\n  ActionMap,\n  ActionMethod,\n  ActionName,\n  Actions,\n  Context,\n  Element,\n  EventTypes,\n  Listeners,\n  ListenersArg,\n  OrBoolean,\n  Target,\n} from '@interactjs/core/types'\nimport * as arr from '@interactjs/utils/arr'\nimport browser from '@interactjs/utils/browser'\nimport clone from '@interactjs/utils/clone'\nimport { getElementRect, matchesUpTo, nodeContains, trySelector } from '@interactjs/utils/domUtils'\nimport extend from '@interactjs/utils/extend'\nimport is from '@interactjs/utils/is'\nimport isNonNativeEvent from '@interactjs/utils/isNonNativeEvent'\nimport normalizeListeners from '@interactjs/utils/normalizeListeners'\nimport { getWindow } from '@interactjs/utils/window'\n\nimport { Eventable } from './Eventable'\nimport type { ActionDefaults, Defaults, OptionsArg, PerActionDefaults, Options } from './options'\n\ntype IgnoreValue = string | Element | boolean\ntype DeltaSource = 'page' | 'client'\n\nconst enum OnOffMethod {\n  On,\n  Off,\n}\n\n/** */\nexport class Interactable implements Partial<Eventable> {\n  /** @internal */ get _defaults (): Defaults {\n    return {\n      base: {},\n      perAction: {},\n      actions: {} as ActionDefaults,\n    }\n  }\n\n  readonly options!: Required<Options>\n  readonly _actions: Actions\n  readonly target: Target\n  readonly events = new Eventable()\n  readonly _context: Context\n  readonly _win: Window\n  readonly _doc: Document\n  readonly _scopeEvents: Scope['events']\n\n  /** */\n  constructor (\n    target: Target,\n    options: any,\n    defaultContext: Document | Element,\n    scopeEvents: Scope['events'],\n  ) {\n    this._actions = options.actions\n    this.target = target\n    this._context = options.context || defaultContext\n    this._win = getWindow(trySelector(target) ? this._context : target)\n    this._doc = this._win.document\n    this._scopeEvents = scopeEvents\n\n    this.set(options)\n  }\n\n  setOnEvents (actionName: ActionName, phases: NonNullable<any>) {\n    if (is.func(phases.onstart)) {\n      this.on(`${actionName}start`, phases.onstart)\n    }\n    if (is.func(phases.onmove)) {\n      this.on(`${actionName}move`, phases.onmove)\n    }\n    if (is.func(phases.onend)) {\n      this.on(`${actionName}end`, phases.onend)\n    }\n    if (is.func(phases.oninertiastart)) {\n      this.on(`${actionName}inertiastart`, phases.oninertiastart)\n    }\n\n    return this\n  }\n\n  updatePerActionListeners (actionName: ActionName, prev: Listeners | undefined, cur: Listeners | undefined) {\n    const actionFilter = (this._actions.map[actionName] as { filterEventType?: (type: string) => boolean })\n      ?.filterEventType\n    const filter = (type: string) =>\n      (actionFilter == null || actionFilter(type)) && isNonNativeEvent(type, this._actions)\n\n    if (is.array(prev) || is.object(prev)) {\n      this._onOff(OnOffMethod.Off, actionName, prev, undefined, filter)\n    }\n\n    if (is.array(cur) || is.object(cur)) {\n      this._onOff(OnOffMethod.On, actionName, cur, undefined, filter)\n    }\n  }\n\n  setPerAction (actionName: ActionName, options: OrBoolean<Options>) {\n    const defaults = this._defaults\n\n    // for all the default per-action options\n    for (const optionName_ in options) {\n      const optionName = optionName_ as keyof PerActionDefaults\n      const actionOptions = this.options[actionName]\n      const optionValue: any = options[optionName]\n\n      // remove old event listeners and add new ones\n      if (optionName === 'listeners') {\n        this.updatePerActionListeners(actionName, actionOptions.listeners, optionValue as Listeners)\n      }\n\n      // if the option value is an array\n      if (is.array(optionValue)) {\n        ;(actionOptions[optionName] as any) = arr.from(optionValue)\n      }\n      // if the option value is an object\n      else if (is.plainObject(optionValue)) {\n        // copy the object\n        ;(actionOptions[optionName] as any) = extend(\n          actionOptions[optionName] || ({} as any),\n          clone(optionValue),\n        )\n\n        // set anabled field to true if it exists in the defaults\n        if (\n          is.object(defaults.perAction[optionName]) &&\n          'enabled' in (defaults.perAction[optionName] as any)\n        ) {\n          ;(actionOptions[optionName] as any).enabled = optionValue.enabled !== false\n        }\n      }\n      // if the option value is a boolean and the default is an object\n      else if (is.bool(optionValue) && is.object(defaults.perAction[optionName])) {\n        ;(actionOptions[optionName] as any).enabled = optionValue\n      }\n      // if it's anything else, do a plain assignment\n      else {\n        ;(actionOptions[optionName] as any) = optionValue\n      }\n    }\n  }\n\n  /**\n   * The default function to get an Interactables bounding rect. Can be\n   * overridden using {@link Interactable.rectChecker}.\n   *\n   * @param {Element} [element] The element to measure.\n   * @return {Rect} The object's bounding rectangle.\n   */\n  getRect (element: Element) {\n    element = element || (is.element(this.target) ? this.target : null)\n\n    if (is.string(this.target)) {\n      element = element || this._context.querySelector(this.target)\n    }\n\n    return getElementRect(element)\n  }\n\n  /**\n   * Returns or sets the function used to calculate the interactable's\n   * element's rectangle\n   *\n   * @param {function} [checker] A function which returns this Interactable's\n   * bounding rectangle. See {@link Interactable.getRect}\n   * @return {function | object} The checker function or this Interactable\n   */\n  rectChecker(): (element: Element) => any | null\n  rectChecker(checker: (element: Element) => any): this\n  rectChecker (checker?: (element: Element) => any) {\n    if (is.func(checker)) {\n      this.getRect = (element) => {\n        const rect = extend({}, checker.apply(this, element))\n\n        if (!(('width' in rect) as unknown)) {\n          rect.width = rect.right - rect.left\n          rect.height = rect.bottom - rect.top\n        }\n\n        return rect\n      }\n\n      return this\n    }\n\n    if (checker === null) {\n      delete (this as Partial<typeof this>).getRect\n\n      return this\n    }\n\n    return this.getRect\n  }\n\n  _backCompatOption (optionName: keyof Options, newValue: any) {\n    if (trySelector(newValue) || is.object(newValue)) {\n      ;(this.options[optionName] as any) = newValue\n\n      for (const action in this._actions.map) {\n        ;(this.options[action as keyof ActionMap] as any)[optionName] = newValue\n      }\n\n      return this\n    }\n\n    return this.options[optionName]\n  }\n\n  /**\n   * Gets or sets the origin of the Interactable's element.  The x and y\n   * of the origin will be subtracted from action event coordinates.\n   *\n   * @param {Element | object | string} [origin] An HTML or SVG Element whose\n   * rect will be used, an object eg. { x: 0, y: 0 } or string 'parent', 'self'\n   * or any CSS selector\n   *\n   * @return {object} The current origin or this Interactable\n   */\n  origin (newValue: any) {\n    return this._backCompatOption('origin', newValue)\n  }\n\n  /**\n   * Returns or sets the mouse coordinate types used to calculate the\n   * movement of the pointer.\n   *\n   * @param {string} [newValue] Use 'client' if you will be scrolling while\n   * interacting; Use 'page' if you want autoScroll to work\n   * @return {string | object} The current deltaSource or this Interactable\n   */\n  deltaSource(): DeltaSource\n  deltaSource(newValue: DeltaSource): this\n  deltaSource (newValue?: DeltaSource) {\n    if (newValue === 'page' || newValue === 'client') {\n      this.options.deltaSource = newValue\n\n      return this\n    }\n\n    return this.options.deltaSource\n  }\n\n  /** @internal */\n  getAllElements (): Element[] {\n    const { target } = this\n\n    if (is.string(target)) {\n      return Array.from(this._context.querySelectorAll(target))\n    }\n\n    if (is.func(target) && (target as any).getAllElements) {\n      return (target as any).getAllElements()\n    }\n\n    return is.element(target) ? [target] : []\n  }\n\n  /**\n   * Gets the selector context Node of the Interactable. The default is\n   * `window.document`.\n   *\n   * @return {Node} The context Node of this Interactable\n   */\n  context () {\n    return this._context\n  }\n\n  inContext (element: Document | Node) {\n    return this._context === element.ownerDocument || nodeContains(this._context, element)\n  }\n\n  testIgnoreAllow (\n    this: Interactable,\n    options: { ignoreFrom?: IgnoreValue, allowFrom?: IgnoreValue },\n    targetNode: Node,\n    eventTarget: Node,\n  ) {\n    return (\n      !this.testIgnore(options.ignoreFrom, targetNode, eventTarget) &&\n      this.testAllow(options.allowFrom, targetNode, eventTarget)\n    )\n  }\n\n  testAllow (this: Interactable, allowFrom: IgnoreValue | undefined, targetNode: Node, element: Node) {\n    if (!allowFrom) {\n      return true\n    }\n\n    if (!is.element(element)) {\n      return false\n    }\n\n    if (is.string(allowFrom)) {\n      return matchesUpTo(element, allowFrom, targetNode)\n    } else if (is.element(allowFrom)) {\n      return nodeContains(allowFrom, element)\n    }\n\n    return false\n  }\n\n  testIgnore (this: Interactable, ignoreFrom: IgnoreValue | undefined, targetNode: Node, element: Node) {\n    if (!ignoreFrom || !is.element(element)) {\n      return false\n    }\n\n    if (is.string(ignoreFrom)) {\n      return matchesUpTo(element, ignoreFrom, targetNode)\n    } else if (is.element(ignoreFrom)) {\n      return nodeContains(ignoreFrom, element)\n    }\n\n    return false\n  }\n\n  /**\n   * Calls listeners for the given InteractEvent type bound globally\n   * and directly to this Interactable\n   *\n   * @param {InteractEvent} iEvent The InteractEvent object to be fired on this\n   * Interactable\n   * @return {Interactable} this Interactable\n   */\n  fire<E extends { type: string }> (iEvent: E) {\n    this.events.fire(iEvent)\n\n    return this\n  }\n\n  _onOff (\n    method: OnOffMethod,\n    typeArg: EventTypes,\n    listenerArg?: ListenersArg | null,\n    options?: any,\n    filter?: (type: string) => boolean,\n  ) {\n    if (is.object(typeArg) && !is.array(typeArg)) {\n      options = listenerArg\n      listenerArg = null\n    }\n\n    const listeners = normalizeListeners(typeArg, listenerArg, filter)\n\n    for (let type in listeners) {\n      if (type === 'wheel') {\n        type = browser.wheelEvent\n      }\n\n      for (const listener of listeners[type]) {\n        // if it is an action event type\n        if (isNonNativeEvent(type, this._actions)) {\n          this.events[method === OnOffMethod.On ? 'on' : 'off'](type, listener)\n        }\n        // delegated event\n        else if (is.string(this.target)) {\n          this._scopeEvents[method === OnOffMethod.On ? 'addDelegate' : 'removeDelegate'](\n            this.target,\n            this._context,\n            type,\n            listener,\n            options,\n          )\n        }\n        // remove listener from this Interactable's element\n        else {\n          this._scopeEvents[method === OnOffMethod.On ? 'add' : 'remove'](\n            this.target,\n            type,\n            listener,\n            options,\n          )\n        }\n      }\n    }\n\n    return this\n  }\n\n  /**\n   * Binds a listener for an InteractEvent, pointerEvent or DOM event.\n   *\n   * @param {string | array | object} types The types of events to listen\n   * for\n   * @param {function | array | object} [listener] The event listener function(s)\n   * @param {object | boolean} [options] options object or useCapture flag for\n   * addEventListener\n   * @return {Interactable} This Interactable\n   */\n  on (types: EventTypes, listener?: ListenersArg, options?: any) {\n    return this._onOff(OnOffMethod.On, types, listener, options)\n  }\n\n  /**\n   * Removes an InteractEvent, pointerEvent or DOM event listener.\n   *\n   * @param {string | array | object} types The types of events that were\n   * listened for\n   * @param {function | array | object} [listener] The event listener function(s)\n   * @param {object | boolean} [options] options object or useCapture flag for\n   * removeEventListener\n   * @return {Interactable} This Interactable\n   */\n  off (types: string | string[] | EventTypes, listener?: ListenersArg, options?: any) {\n    return this._onOff(OnOffMethod.Off, types, listener, options)\n  }\n\n  /**\n   * Reset the options of this Interactable\n   *\n   * @param {object} options The new settings to apply\n   * @return {object} This Interactable\n   */\n  set (options: OptionsArg) {\n    const defaults = this._defaults\n\n    if (!is.object(options)) {\n      options = {}\n    }\n\n    ;(this.options as Required<Options>) = clone(defaults.base) as Required<Options>\n\n    for (const actionName_ in this._actions.methodDict) {\n      const actionName = actionName_ as ActionName\n      const methodName = this._actions.methodDict[actionName]\n\n      this.options[actionName] = {}\n      this.setPerAction(actionName, extend(extend({}, defaults.perAction), defaults.actions[actionName]))\n      ;(this[methodName] as ActionMethod<unknown>)(options[actionName])\n    }\n\n    for (const setting in options) {\n      if (setting === 'getRect') {\n        this.rectChecker(options.getRect)\n        continue\n      }\n\n      if (is.func((this as any)[setting])) {\n        ;(this as any)[setting](options[setting as keyof typeof options])\n      }\n    }\n\n    return this\n  }\n\n  /**\n   * Remove this interactable from the list of interactables and remove it's\n   * action capabilities and event listeners\n   */\n  unset () {\n    if (is.string(this.target)) {\n      // remove delegated events\n      for (const type in this._scopeEvents.delegatedEvents) {\n        const delegated = this._scopeEvents.delegatedEvents[type]\n\n        for (let i = delegated.length - 1; i >= 0; i--) {\n          const { selector, context, listeners } = delegated[i]\n\n          if (selector === this.target && context === this._context) {\n            delegated.splice(i, 1)\n          }\n\n          for (let l = listeners.length - 1; l >= 0; l--) {\n            this._scopeEvents.removeDelegate(\n              this.target,\n              this._context,\n              type,\n              listeners[l][0],\n              listeners[l][1],\n            )\n          }\n        }\n      }\n    } else {\n      this._scopeEvents.remove(this.target, 'all')\n    }\n  }\n}\n"
	],
	"mappings": "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"
}